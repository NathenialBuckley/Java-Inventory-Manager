## Project Overview

A full-stack Spring Boot inventory management system with user authentication, transaction tracking, and multi-environment support. Built with Java 21, Spring Boot 2.7.14, PostgreSQL (production), and H2 (development).

## Build System & Commands

This is a Maven project using Spring Boot 2.7.14.

### Build and Run

```bash
# Build the project
mvn clean package

# Run in DEVELOPMENT mode (H2 in-memory database)
mvn spring-boot:run -Dspring-boot.run.profiles=dev

# Run in PRODUCTION mode (PostgreSQL)
mvn spring-boot:run -Dspring-boot.run.profiles=prod

# Or set environment variable
export SPRING_PROFILES_ACTIVE=dev
mvn spring-boot:run

# Run tests
mvn test

# Run a single test
mvn test -Dtest=InventoryApiIntegrationTest
mvn test -Dtest=InventoryApiIntegrationTest#basicCreateAndGet
```

### Access the Application

- **Application**: http://localhost:8080
- **H2 Console** (dev mode only): http://localhost:8080/h2-console
  - JDBC URL: `jdbc:h2:mem:inventorydb`
  - Username: `sa`
  - Password: (leave blank)
## Architecture

The application follows a standard 3-layer Spring Boot architecture:

**Controller Layer** (`controller/`)
- `InventoryController` - REST endpoints at `/api/items`
- Uses constructor injection for the service layer
- Returns `ResponseEntity` objects with appropriate HTTP status codes

**Service Layer** (`service/`)
- `InventoryService` - Business logic and validation
- Validates required fields (name, sku) in the `create()` method
- Throws `IllegalArgumentException` for validation failures and missing entities

**Repository Layer** (`repository/`)
- `ItemRepository` - JPA repository extending `JpaRepository<Item, Long>`
- Includes custom query method `findBySku(String sku)` (defined but not currently used in service layer)

**Model** (`model/`)
- `Item` - JPA entity mapped to "items" table
- Fields: id (Long, auto-generated), name, sku, quantity (Integer), price (BigDecimal)

## Environment Configuration

The application supports multiple environments using Spring profiles:

### Development Environment (`dev` profile)
- **Database**: H2 in-memory database
- **Auto-created** on startup, destroyed on shutdown
- **H2 Console**: Enabled at `/h2-console`
- **Schema**: Auto-generated by Hibernate
- **Logging**: Verbose SQL logging enabled

### Production Environment (`prod` profile)
- **Database**: PostgreSQL
- **Platform Support**: Render, Railway, or custom PostgreSQL
- **SSL**: Enabled for cloud databases
- **Schema**: Managed by Hibernate with `ddl-auto=update`
- **Logging**: Reduced verbosity for performance

### Configuration Files
- `application.properties` - Common settings and profile activation
- `application-dev.properties` - Development-specific settings
- `application-prod.properties` - Production-specific settings

## Deployment

### Deploying to Render

1. **Create a PostgreSQL database** in Render
2. **Create a Web Service** and connect it to your GitHub repository
3. **Set Environment Variables**:
   ```
   SPRING_PROFILES_ACTIVE=prod
   ```
   (Render automatically provides `DATABASE_URL` which is auto-detected)

4. **Build Command**:
   ```
   mvn clean package -DskipTests
   ```

5. **Start Command**:
   ```
   java -jar target/inventory-manager-1.0-SNAPSHOT.jar
   ```

### Deploying to Railway

1. **Create a PostgreSQL database** in Railway
2. **Create a new project** from GitHub
3. **Railway auto-provides**: `PGHOST`, `PGPORT`, `PGUSER`, `PGPASSWORD`, `PGDATABASE`
4. **Set Environment Variable**:
   ```
   SPRING_PROFILES_ACTIVE=prod
   ```

### Local Production Mode

To test production mode locally with PostgreSQL:

```bash
# Install PostgreSQL locally
# Create database: createdb inventorydb

# Set environment variables
export SPRING_PROFILES_ACTIVE=prod
export PGHOST=localhost
export PGPORT=5432
export PGDATABASE=inventorydb
export PGUSER=your_username
export PGPASSWORD=your_password

# Run application
mvn spring-boot:run
```

## Features

### Core Functionality
- **User Authentication**: Secure login/registration with Spring Security
- **Inventory Management**: Full CRUD operations for inventory items
- **Transaction Tracking**: Complete audit trail for all buy/sell operations
- **Financial Analytics**: Real-time tracking of spending, sales, and profit
- **Multi-tenancy**: User-isolated data (users only see their own items/transactions)

### Transaction System
- **Atomic Operations**: Buy/sell transactions automatically update inventory
- **Audit Trail**: Records inventory snapshots before and after each transaction
- **Transaction Status**: PENDING, COMPLETED, FAILED, REVERSED
- **Notes Support**: Optional notes for each transaction
- **Type Safety**: Enum-based transaction types (BUY/SELL)

### User Interface
- **Modern Design**: Gradient UI with responsive layout
- **Tabbed Interface**: Separate views for Inventory and Transactions
- **Modal Dialogs**: User-friendly buy/sell workflows
- **Real-time Updates**: Automatic refresh after operations
- **Color-coded Badges**: Visual distinction for transaction types

### Security
- **Session-based Authentication**: Secure cookie-based sessions
- **Password Encryption**: BCrypt password hashing
- **User Isolation**: Row-level security for all data
- **CSRF Protection**: Enabled for form submissions

## API Endpoints

### Authentication
- `POST /api/auth/register` - Create new user account
- `POST /api/auth/login` - Login with username/password
- `POST /api/auth/logout` - Logout current user
- `GET /api/auth/current` - Get current user info

### Items
- `GET /api/items` - List all items for current user
- `GET /api/items/{id}` - Get specific item
- `POST /api/items` - Create new item
- `PUT /api/items/{id}` - Update item
- `DELETE /api/items/{id}` - Delete item

### Transactions
- `GET /api/transactions` - List all transactions for current user
- `GET /api/transactions/item/{itemId}` - Get transactions for specific item
- `GET /api/transactions/summary` - Get financial summary (spending, sales, profit)
- `POST /api/transactions` - Create new transaction (buy/sell)

## Testing

Integration tests use `@SpringBootTest` with `TestRestTemplate` to test the full REST API stack. Tests run on a random port to avoid conflicts.

## Technology Stack

- **Backend**: Spring Boot 2.7.14, Java 21
- **Security**: Spring Security with BCrypt
- **Database**: PostgreSQL (prod), H2 (dev)
- **ORM**: Spring Data JPA, Hibernate
- **Frontend**: Vanilla JavaScript, HTML5, CSS3
- **Build Tool**: Maven 3.9+
- **Deployment**: Render, Railway compatible
